<!-- pages/settings/settings.wxml -->
<view class="container">
  <!-- Header Section -->
  <view class="header">
    <text class="title">{{language === 'en' ? 'Settings' : 'è®¾ç½®'}}</text>
    <text class="subtitle">{{language === 'en' ? 'Select your search engine' : 'é€‰æ‹©æ‚¨çš„æœç´¢å¼•æ“'}}</text>
  </view>

  <!-- Unified Section: Notice + Search Engine Selection -->
  <view class="unified-section">
    <!-- Recommendation Tip -->
    <view class="recommendation-tip">
      <text class="tip-icon">ğŸ’¡</text>
      <view class="tip-content">
        <text class="tip-title">{{language === 'en' ? 'Recommendation' : 'æ¨è'}}</text>
        <text class="tip-text">{{language === 'en' ? 'Fast Search offers the best balance of speed and quality for daily use.' : 'å¿«é€Ÿæœç´¢åœ¨é€Ÿåº¦å’Œè´¨é‡ä¹‹é—´å–å¾—äº†æœ€ä½³å¹³è¡¡ï¼Œé€‚åˆæ—¥å¸¸ä½¿ç”¨ã€‚'}}</text>
      </view>
    </view>

    <!-- Section Header -->
    <view class="section-header">
      <text class="section-title">{{language === 'en' ? 'Search Engine Selection' : 'æœç´¢å¼•æ“é€‰æ‹©'}}</text>
      <text class="section-desc">{{language === 'en' ? 'Choose which search engine to use for finding articles' : 'é€‰æ‹©ç”¨äºæŸ¥æ‰¾æ–‡ç« çš„æœç´¢å¼•æ“'}}</text>
    </view>

    <!-- Search Engine Options -->
    <radio-group class="model-options" bindchange="onModelChange">
      <!-- Quality Search Engine (GLM-4.7) -->
      <label class="model-card {{selectedModel === 'glm-4.7' ? 'active' : ''}}">
        <radio value="glm-4.7" checked="{{selectedModel === 'glm-4.7'}}" class="hidden-radio" />
        <view class="model-card-content">
          <view class="model-icon-wrapper">
            <text class="model-icon">ğŸ“š</text>
          </view>
          <view class="model-details">
            <text class="model-name">{{language === 'en' ? 'Quality Search' : 'è´¨é‡æœç´¢'}}</text>
            <text class="model-subname"></text>
            <text class="model-tags">
              <text class="tag tag-quality">{{language === 'en' ? 'Quality' : 'è´¨é‡å¥½'}}</text>
              <text class="tag tag-speed">{{language === 'en' ? 'Slightly Slow' : 'ç¨æ…¢'}}</text>
            </text>
            <text class="model-desc">{{language === 'en' ? 'âœ… Comprehensive search results with detailed information' : 'âœ… å…¨é¢çš„æœç´¢ç»“æœï¼Œä¿¡æ¯è¯¦ç»†'}}</text>
          </view>
          <view class="model-indicator {{selectedModel === 'glm-4.7' ? 'active' : ''}}">
            <view class="indicator-dot"></view>
          </view>
        </view>
      </label>

      <!-- Fast Search Engine (DeepSeek-Chat) -->
      <label class="model-card {{selectedModel === 'deepseek-chat' ? 'active' : ''}}">
        <radio value="deepseek-chat" checked="{{selectedModel === 'deepseek-chat'}}" class="hidden-radio" />
        <view class="model-card-content">
          <view class="model-icon-wrapper">
            <text class="model-icon">âš¡</text>
          </view>
          <view class="model-details">
            <text class="model-name">{{language === 'en' ? 'Fast Search' : 'å¿«é€Ÿæœç´¢'}}</text>
            <text class="model-subname"></text>
            <text class="model-tags">
              <text class="tag tag-quality tag-recommended">{{language === 'en' ? 'Good Quality' : 'è´¨é‡å¥½'}}</text>
              <text class="tag tag-speed tag-recommended">{{language === 'en' ? 'Fast' : 'å¿«é€Ÿ'}}</text>
            </text>
            <text class="model-desc">{{language === 'en' ? 'âœ… Quick results with good quality â€¢ Recommended' : 'âœ… å¿«é€Ÿç»“æœä¸”è´¨é‡å¥½ â€¢ æ¨è'}}</text>
          </view>
          <view class="model-indicator {{selectedModel === 'deepseek-chat' ? 'active' : ''}}">
            <view class="indicator-dot"></view>
          </view>
        </view>
      </label>

      <!-- Deep Search Engine (DeepSeek-Reasoner) -->
      <label class="model-card {{selectedModel === 'deepseek-reasoner' ? 'active' : ''}}">
        <radio value="deepseek-reasoner" checked="{{selectedModel === 'deepseek-reasoner'}}" class="hidden-radio" />
        <view class="model-card-content">
          <view class="model-icon-wrapper">
            <text class="model-icon">ğŸ”¬</text>
          </view>
          <view class="model-details">
            <text class="model-name">{{language === 'en' ? 'Deep Search' : 'æ·±åº¦æœç´¢'}}</text>
            <text class="model-subname"></text>
            <text class="model-tags">
              <text class="tag tag-quality tag-best">{{language === 'en' ? 'Best Quality' : 'æœ€ä½³è´¨é‡'}}</text>
              <text class="tag tag-speed tag-slowest">{{language === 'en' ? 'Slowest' : 'æœ€æ…¢'}}</text>
            </text>
            <text class="model-desc">{{language === 'en' ? 'âœ… In-depth analysis with comprehensive results' : 'âœ… æ·±å…¥åˆ†æï¼Œç»“æœå…¨é¢'}}</text>
          </view>
          <view class="model-indicator {{selectedModel === 'deepseek-reasoner' ? 'active' : ''}}">
            <view class="indicator-dot"></view>
          </view>
        </view>
      </label>
    </radio-group>
  </view>

  <!-- Backend Status Section -->
  <view class="unified-section">
    <!-- Section Header -->
    <view class="section-header">
      <text class="section-title">{{language === 'en' ? 'Backend Connection' : 'åç«¯è¿æ¥'}}</text>
      <text class="section-desc">{{language === 'en' ? 'AI services powered by secure backend' : 'AIæœåŠ¡ç”±å®‰å…¨åç«¯æä¾›'}}</text>
    </view>

    <!-- Status Indicator -->
    <view class="status-group">
      <text class="status-label">{{language === 'en' ? 'Backend Status' : 'åç«¯çŠ¶æ€'}}</text>
      <view class="status-indicator {{backendConnected ? 'connected' : 'disconnected'}}">
        <text class="status-dot"></text>
        <text class="status-text">{{backendConnected ? (language === 'en' ? 'âœ“ Connected' : 'âœ“ å·²è¿æ¥') : (language === 'en' ? 'âœ— Disconnected' : 'âœ— æœªè¿æ¥')}}</text>
      </view>
    </view>

    <!-- Backend URL Input -->
    <view class="input-group">
      <text class="input-label">{{language === 'en' ? 'Backend URL' : 'åç«¯åœ°å€'}}</text>
      <input
        class="api-input"
        type="text"
        placeholder="{{language === 'en' ? 'https://your-backend.com' : 'https://your-backend.com'}}"
        value="{{backendUrl}}"
        bindinput="onBackendUrlInput"
      />
    </view>

    <!-- Connect Button -->
    <button class="save-btn" bindtap="testBackendConnection">
      <text>{{language === 'en' ? 'ğŸ” Test Connection' : 'ğŸ” æµ‹è¯•è¿æ¥'}}</text>
    </button>

    <!-- Help Tip -->
    <view class="help-tip">
      <text class="help-icon">ğŸ”’</text>
      <text class="help-text">{{language === 'en' ? 'Your API keys are securely stored on the backend. The mini program never sees your keys.' : 'æ‚¨çš„APIå¯†é’¥å®‰å…¨å­˜å‚¨åœ¨åç«¯ã€‚å°ç¨‹åºæ— æ³•è®¿é—®æ‚¨çš„å¯†é’¥ã€‚'}}</text>
    </view>
  </view>

  <!-- Back Button -->
  <view class="button-container">
    <button class="back-btn" bindtap="goBack">
      <text class="back-btn-icon">â†</text>
      <text class="back-btn-text">{{language === 'en' ? 'Back' : 'è¿”å›'}}</text>
    </button>
  </view>
</view>
